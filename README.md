# Лабораторная работа №3: Обработка данных форм на стороне сервера (PHP)

## Автор
**ФИО:** Богатов Андрей Николаевич  
**Группа:** 2ПМИ-ИП2-ПГ3

## Цель работы
Научиться обрабатывать данные HTML-форм на стороне сервера с помощью PHP, работать с сессиями для передачи информации между страницами и сохранять данные в текстовые файлы.

## Ход работы

### Шаг 1: Подготовка формы
- В файле `form.html` обновлен тег `<form>`: добавлены атрибуты `action="process.php"` и `method="POST"`.
- Удалена сложная JS-обработка (preventDefault), оставлен только `alert` для уведомления пользователя перед отправкой данных на сервер.

### Шаг 2: Создание обработчика (process.php)
- Реализован скрипт `process.php`, который:
  - Инициализирует сессию через `session_start()`.
  - Получает данные из массива `$_POST` и фильтрует их через `htmlspecialchars`.
  - Проводит **валидацию** (проверка на пустое имя и возраст >= 16).
  - Сохраняет ошибки или успешные данные в `$_SESSION`.
  - Записывает данные в файл `data.txt` в формате `Имя;Возраст;Факультет;Форма`.

### Шаг 3: Вывод данных из сессии (index.php)
- Файл `index.php` переписан для отображения результатов:
  - Выводит список ошибок в красном блоке, если валидация не пройдена.
  - Показывает данные последнего зарегистрированного студента из сессии.
  - Содержит навигационные ссылки на форму и страницу просмотра всех данных.

### Шаг 4: Хранение и просмотр данных (view.php)
- Создан файл `view.php` для чтения истории записей:
  - Скрипт проверяет наличие файла `data.txt`.
  - Построчно читает файл и разбивает данные с помощью `explode(";")`.
  - Выводит список всех зарегистрированных пользователей в удобном виде.

## Вывод
В ходе работы освоены принципы серверной обработки данных. Изучена работа с глобальными массивами `$_POST` и `$_SESSION`, механизмы редиректа через `header()`, а также базовые операции с файловой системой в PHP.

## Исходный код ключевых файлов

### Файл `process.php` (Логика и валидация)
```php
<?php
session_start();
$username = htmlspecialchars($_POST['student_name'] ?? '');
$age = htmlspecialchars($_POST['age'] ?? '');

$errors = [];
if (empty($username)) $errors[] = "Имя не может быть пустым";
if (empty($age) || $age < 16) $errors[] = "Возраст должен быть >= 16";

if (!empty($errors)) {
    $_SESSION['errors'] = $errors;
    header("Location: index.php");
    exit();
}

$_SESSION['username'] = $username;
$_SESSION['age'] = $age;

$line = "$username;$age;" . ($_POST['faculty']??'') . ";" . ($_POST['education_type']??'') . "\n";
file_put_contents("data.txt", $line, FILE_APPEND);

header("Location: index.php");
exit();